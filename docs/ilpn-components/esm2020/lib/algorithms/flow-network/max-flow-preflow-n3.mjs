export class MaxFlowPreflowN3 {
    constructor(n) {
        this.n = n;
        this.cap = [];
        for (let i = 0; i < n; i++) {
            this.cap.push(new Array(n).fill(0));
        }
    }
    setCap(i, j, cap) {
        this.cap[i][j] = cap;
    }
    setUnbounded(i, j) {
        this.setCap(i, j, 20000);
    }
    getCap(i, j) {
        return this.cap[i][j];
    }
    maxFlow(s, t) {
        const h = new Array(this.n).fill(0);
        h[s] = this.n - 1;
        const maxh = new Array(this.n).fill(0);
        const f = [];
        for (let i = 0; i < this.n; i++) {
            f.push(new Array(this.n).fill(0));
        }
        const e = new Array(this.n).fill(0);
        for (let i = 0; i < this.n; i++) {
            f[s][i] = this.cap[s][i];
            f[i][s] = -f[s][i];
            e[i] = this.cap[s][i];
        }
        for (let sz = 0;;) {
            if (sz === 0) {
                for (let i = 0; i < this.n; i++) {
                    if (i !== s && i !== t && e[i] > 0) {
                        if (sz !== 0 && h[i] > h[maxh[0]]) {
                            sz = 0;
                        }
                        maxh[sz++] = i;
                    }
                }
            }
            if (sz === 0) {
                break;
            }
            while (sz !== 0) {
                let i = maxh[sz - 1];
                let pushed = false;
                for (let j = 0; j < this.n && e[i] !== 0; j++) {
                    if (h[i] === h[j] + 1 && this.cap[i][j] - f[i][j] > 0) {
                        const df = Math.min(this.cap[i][j] - f[i][j], e[i]);
                        f[i][j] += df;
                        f[j][i] -= df;
                        e[i] -= df;
                        e[j] += df;
                        if (e[i] === 0) {
                            sz--;
                        }
                        pushed = true;
                    }
                }
                if (!pushed) {
                    h[i] = 20000;
                    for (let j = 0; j < this.n; j++) {
                        if (h[i] > h[j] + 1 && this.cap[i][j] - f[i][j] > 0) {
                            h[i] = h[j] + 1;
                        }
                    }
                    if (h[i] > h[maxh[0]]) {
                        sz = 0;
                        break;
                    }
                }
            }
        }
        let flow = 0;
        for (let i = 0; i < this.n; i++) {
            flow += f[s][i];
        }
        return flow;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWF4LWZsb3ctcHJlZmxvdy1uMy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2NvbXBvbmVudHMvc3JjL2xpYi9hbGdvcml0aG1zL2Zsb3ctbmV0d29yay9tYXgtZmxvdy1wcmVmbG93LW4zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sT0FBTyxnQkFBZ0I7SUFJekIsWUFBWSxDQUFTO1FBQ2pCLElBQUksQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ1gsSUFBSSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUM7UUFDZCxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO1lBQ3hCLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFTLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQy9DO0lBQ0wsQ0FBQztJQUVNLE1BQU0sQ0FBQyxDQUFTLEVBQUUsQ0FBUyxFQUFFLEdBQVc7UUFDM0MsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7SUFDekIsQ0FBQztJQUVNLFlBQVksQ0FBQyxDQUFTLEVBQUUsQ0FBUztRQUNwQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVNLE1BQU0sQ0FBQyxDQUFTLEVBQUUsQ0FBUztRQUM5QixPQUFPLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDMUIsQ0FBQztJQUVNLE9BQU8sQ0FBQyxDQUFTLEVBQUUsQ0FBUztRQUMvQixNQUFNLENBQUMsR0FBRyxJQUFJLEtBQUssQ0FBUyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxD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SjtTQUNKO1FBRUQsSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDO1FBQ2IsS0FBSyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDN0IsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztTQUNuQjtRQUVELE9BQU8sSUFBSSxDQUFDO0lBQ2hCLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBNYXhGbG93UHJlZmxvd04zIHtcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgbjogbnVtYmVyO1xyXG4gICAgcHJpdmF0ZSByZWFkb25seSBjYXA6IEFycmF5PEFycmF5PG51bWJlcj4+O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG46IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMubiA9IG47XHJcbiAgICAgICAgdGhpcy5jYXAgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xyXG4gICAgICAgICAgICB0aGlzLmNhcC5wdXNoKG5ldyBBcnJheTxudW1iZXI+KG4pLmZpbGwoMCkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0Q2FwKGk6IG51bWJlciwgajogbnVtYmVyLCBjYXA6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuY2FwW2ldW2pdID0gY2FwO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXRVbmJvdW5kZWQoaTogbnVtYmVyLCBqOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnNldENhcChpLCBqLCAyMDAwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGdldENhcChpOiBudW1iZXIsIGo6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2FwW2ldW2pdO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBtYXhGbG93KHM6IG51bWJlciwgdDogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgICAgICBjb25zdCBoID0gbmV3IEFycmF5PG51bWJlcj4odGhpcy5uKS5maWxsKDApO1xyXG4gICAgICAgIGhbc10gPSB0aGlzLm4gLSAxO1xyXG5cclxuICAgICAgICBjb25zdCBtYXhoID0gbmV3IEFycmF5PG51bWJlcj4odGhpcy5uKS5maWxsKDApO1xyXG4gICAgICAgIGNvbnN0IGY6IEFycmF5PEFycmF5PG51bWJlcj4+ID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm47IGkrKykge1xyXG4gICAgICAgICAgICBmLnB1c2gobmV3IEFycmF5PG51bWJlcj4odGhpcy5uKS5maWxsKDApKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZSA9IG5ldyBBcnJheTxudW1iZXI+KHRoaXMubikuZmlsbCgwKTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm47IGkrKykge1xyXG4gICAgICAgICAgICBmW3NdW2ldID0gdGhpcy5jYXBbc11baV07XHJcbiAgICAgICAgICAgIGZbaV1bc10gPSAtZltzXVtpXTtcclxuICAgICAgICAgICAgZVtpXSA9IHRoaXMuY2FwW3NdW2ldO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZm9yIChsZXQgc3ogPSAwOyA7KSB7XHJcbiAgICAgICAgICAgIGlmIChzeiA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLm47IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpICE9PSBzICYmIGkgIT09IHQgJiYgZVtpXSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN6ICE9PSAwICYmIGhbaV0gPiBoW21heGhbMF1dKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzeiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4aFtzeisrXSA9IGk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChzeiA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgd2hpbGUgKHN6ICE9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaSA9IG1heGhbc3ogLSAxXTtcclxuICAgICAgICAgICAgICAgIGxldCBwdXNoZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5uICYmIGVbaV0gIT09IDA7IGorKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChoW2ldID09PSBoW2pdICsgMSAmJiB0aGlzLmNhcFtpXVtqXSAtIGZbaV1bal0gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGRmID0gTWF0aC5taW4odGhpcy5jYXBbaV1bal0gLSBmW2ldW2pdLCBlW2ldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZltpXVtqXSArPSBkZjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZltqXVtpXSAtPSBkZjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZVtpXSAtPSBkZjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZVtqXSArPSBkZjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVbaV0gPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN6LS07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcHVzaGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIXB1c2hlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhbaV0gPSAyMDAwMDtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMubjsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoW2ldID4gaFtqXSArIDEgJiYgdGhpcy5jYXBbaV1bal0gLSBmW2ldW2pdID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaFtpXSA9IGhbal0gKyAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChoW2ldID4gaFttYXhoWzBdXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzeiA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGZsb3cgPSAwO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uOyBpKyspIHtcclxuICAgICAgICAgICAgZmxvdyArPSBmW3NdW2ldO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZsb3c7XHJcbiAgICB9XHJcbn1cclxuIl19